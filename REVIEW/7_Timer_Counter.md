# 7. 8비트 타이머/카운터의 동작  
> **<목차>**  
> 7.1 타이머/카운터 개요  
> 7.2 8비트 타이머/카운터2의 동작  
> 7.3 8비트 타이머/카운터0의 동작  
> 7.4 8비트 타이머/카운터 활용 실험  
> - 일반 모드  
> - CTC 모드  
> - 고속 PWM 모드  
> - PC PWM 모드  

<br>

## 7.1 타이머/카운터 개요  
- 타이머/카운터 개요
  + 클럭이 입력되면 들어오는 클럭을 계수하는 기능 
  + 타이머/카운터의 각 단계는 입력 클럭을 *2분주* 하여 동작하는 하나의 D 플립플롭 (D-type negative edge-triggered)으로 되어있으며, D플립플롭의 출력은 다음 단의 D 입력에 연결되어 있음
  + 오버플로우 : 3-비트 타이머/카운터의 경우 카운터의 상태가 111에서 000으로 변화할 때 발생함. -> 플래그 플립플롭에 오버플로우가 발생했음을 알림  

<br>

- 타이머/카운터의 구분
  + 타이머 모드 : MCU의 ***내부*** 클럭을 입력으로 사용하여 이를 분주해서 클럭 소스로 사용하는 경우
  + 카운터 모드 : MCU의 ***외부***에서 입력되는 클럭 신호를 받아서 이를 클럭 소스로 사용하는 경우
  + ATmega128의 타이머/카운터
    * 2개의 8비트 타이머/카운터 (T0, T2)
    * 2개의 16비트 타이머/카운터 (T1, T3)
    * 다른 프로세서에 비해 PWM 기능이 추가 
    
<br>

- 타이머/카운터의 기능  
(1) 일정 시간 간격을 갖는 펄스의 발생  
(2) 외부 사건의 계수하는 기능  
(3) PWM 펄스의 발생  

  + 타이머 응용   
    * 타이머는 주기적인 시간 간격으로 오버플로우가 발생되도록 프로그램되고 이 오버플로우가 발생할 때마다 오버플로우 플래그가 설정된다. 
    이 플래그는 펄스의 입력 상태를 확인하여 이 플래그가 발생하였으면 출력 포트에 데이터를 보내고, 또는 주기적으로 일정 시간 간격으로 어떤 일을 수행하는 등의 동작을 동기화하는데 이용된다.
    * 외부에서 발생되는 펄스의 시간 간격을 계측하기 위해 타이머를 사용하여 외부에서 입력되는 펄스보다 작은 간격을 갖는 주기적인 펄스를 만들어 
    두가지 상태(ON/OFF)의 시간을 측정하는 응용으로도 사용될 수 있음
  + 카운터 응용   
    * 외부 사건의 발생 회수를 계수하기 위해 사용됨
    * 사건은 어떤 외부적인 자극으로 ATmega128 IC의 핀에서 1 또는 0 상태로 공급되며, 이를 계수하여 사건의 발생 회수 및 사건의 발생 여부를 확인
  + PWM 응용
    * ATmega128의 타이머/카운터에는 비교 모듈(compare unit) 내장
    * 이 모듈을 이용해 일반적인 파형의 발생과 PWM 신호를 발생 

<br>

- PWM 신호  
 ![image](https://user-images.githubusercontent.com/72501562/121785008-42501200-cbf2-11eb-9a0d-760fe38c1cd4.png)
  + PWM 신호 : 일정한 주기를 갖는 신호를 Tw 시간동안 Ton의 폭으로 ON/OFF 제어를 하는 것 
  + 즉, ON 되는 시간의 펄스폭을 넓게 하면 출력되는 평균 전압이 커지게 되고, ON 되는 시간의 펄스폭(Ton)을 좁게 하면 평균 전압이 작아짐
  + --> 펄스 폭 (Ton)을 디지털 값으로 제어함으로써 평균전압의 크기를 조절하는 방식 => ***PWM제어*** 
  + ![image](https://user-images.githubusercontent.com/72501562/121785208-6102d880-cbf3-11eb-939d-b12be5a78547.png)
  + ![image](https://user-images.githubusercontent.com/72501562/121785210-68c27d00-cbf3-11eb-8bd6-e11a6b1a8527.png)





















